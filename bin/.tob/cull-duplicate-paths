cull_duplicate_paths () {
    local entry
    local unique
    declare -i i
    # arrays types and mpaths are 1:1, so scan types, discard from both
    for (( i=${#types[@]}; i>=0; i-- )); do
        entry=${types[$i]}
        test "${unique/$entry/}" = "$unique" || {
            # this entry already scanned
            unset types[$i]
            unset mpaths[$i]
            continue
            }
        unique+=" $entry"
    done
    unset unique
    # apaths array can include duplicates, so scan & discard, leaving last
    for (( i=${#apaths[@]}; i>=0; i-- )); do
        entry=${apaths[$i]}
        test "${unique/$entry/}" = "$unique" || {
            # this entry already scanned
            unset apaths[$i]
            continue
            }
        unique+=" $entry"
    done
    }
